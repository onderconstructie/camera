<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Camera — Real-time Objectherkenning</title>
    
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow-models/coco-ssd"></script>
    
    <style>
        :root {
            --slate-50: #f8fafc;
            --slate-100: #f1f5f9;
            --slate-200: #e2e8f0;
            --slate-400: #94a3b8;
            --slate-500: #64748b;
            --slate-700: #334155;
            --slate-800: #1e293b;
            --white: #ffffff;
            --accent: #10b981;
            --green-50: #f0fdf4;
            --radius-lg: 16px;
            --radius-md: 12px;
            --radius-sm: 8px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--slate-50);
            color: var(--slate-700);
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        /* Header */
        .header {
            background: var(--white);
            border-bottom: 1px solid var(--slate-200);
            padding: 1.5rem;
            position: relative;
        }

        .header-content {
            max-width: 1100px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 16px;
        }

        /* De Terug-link */
        .back-link {
            position: absolute;
            left: 1.5rem;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 8px; 
            text-decoration: none;
            color: var(--slate-500); 
            font-weight: 500; 
            font-size: 1rem;
            transition: color 0.2s ease;
            z-index: 10;
        }
        .back-link:hover { color: var(--accent); }
        .back-link svg { width: 20px; height: 20px; stroke-width: 2; }

        @media (max-width: 600px) {
            .back-link span { display: none; } 
            .back-link { left: 1rem; }
            .header { padding: 1rem; }
        }

        .logo-circle {
            width: 42px;
            height: 42px;
            background: var(--green-50);
            border: 2px solid var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .logo-circle svg {
            width: 24px;
            height: 24px;
            stroke: var(--accent);
            fill: none;
            stroke-width: 2;
        }

        h1 { font-size: 1.5rem; font-weight: 800; color: var(--slate-800); margin: 0; line-height: 1; }
        .subtitle { font-size: 0.875rem; color: var(--slate-500); margin-top: 4px; font-weight: 500; }

        /* Grid Layout */
        .container {
            max-width: 1100px;
            margin: 2rem auto;
            padding: 0 1.5rem;
            display: grid;
            grid-template-columns: 1fr 380px;
            gap: 2rem;
            flex: 1;
            width: 100%;
            box-sizing: border-box;
        }

        .card {
            background: var(--white);
            border-radius: var(--radius-lg);
            border: 1.5px solid var(--slate-200);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        .card-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            color: var(--slate-400);
            margin-bottom: 1.25rem;
        }

        /* Loader */
        #loader {
            position: absolute;
            inset: 0;
            background: var(--white);
            z-index: 10;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-lg);
        }

        .spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--green-50);
            border-top: 3px solid var(--accent);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin-bottom: 1rem;
        }

        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }

        /* Video Area */
        .canvas-container {
            position: relative;
            border-radius: var(--radius-md);
            overflow: hidden;
            background: #000;
            line-height: 0;
        }

        video { width: 100%; height: auto; }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; }

        /* Settings Area */
        .settings-area {
            margin-top: 1.5rem;
            padding: 1.25rem;
            background: var(--slate-50);
            border-radius: var(--radius-md);
            border: 1px solid var(--slate-200);
        }

        .slider-label {
            display: flex;
            justify-content: space-between;
            font-size: 0.8125rem;
            font-weight: 700;
            color: var(--slate-700);
            margin-bottom: 8px;
        }

        input[type=range] { width: 100%; accent-color: var(--accent); cursor: pointer; }

        /* Icon Grid */
        .icon-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 1.25rem;
            margin-bottom: 1.5rem;
            min-height: 100px;
        }

        .styled-icon-box {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            animation: fadeIn 0.4s ease forwards;
        }

        .icon-circle {
            width: 60px;
            height: 60px;
            background: var(--green-50);
            border: 2px solid var(--accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .icon-circle svg { width: 28px; height: 28px; stroke: var(--accent); fill: none; stroke-width: 1.5; }
        .icon-label { font-size: 0.75rem; font-weight: 600; color: var(--slate-800); text-align: center; }

        /* Buttons & Details */
        .btn-action {
            width: 100%;
            padding: 0.875rem;
            background: var(--white);
            border: 1.5px solid var(--slate-200);
            border-radius: var(--radius-sm);
            font-weight: 700;
            color: var(--slate-700);
            cursor: pointer;
            margin-bottom: 0.75rem;
            transition: 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .btn-action:hover { border-color: var(--accent); background: var(--green-50); color: var(--accent); }
        
        .btn-action svg { width: 18px; height: 18px; }

        details { border-top: 1px solid var(--slate-100); margin-top: 1rem; }
        summary { padding: 1rem 0; font-size: 0.8125rem; font-weight: 700; color: var(--slate-500); cursor: pointer; list-style: none; display: flex; justify-content: space-between; }
        
        .info-text { font-size: 0.75rem; color: var(--slate-500); line-height: 1.6; margin: 0; padding-bottom: 0.5rem; }

        /* Footer Style */
        .footer {
            text-align: center;
            padding: 2rem;
            background: var(--white);
            border-top: 1px solid var(--slate-200);
            margin-top: 2rem;
        }

        .footer-quote {
            color: var(--accent);
            font-size: 0.875rem;
            font-weight: 500;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

    <header class="header">
        <a href="https://onderconstructie.github.io/fun" class="back-link">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round">
                <line x1="19" y1="12" x2="5" y2="12"></line>
                <polyline points="12 19 5 12 12 5"></polyline>
            </svg>
            <span>Fun</span>
        </a>

        <div class="header-content">
            <div class="logo-circle">
                <svg viewBox="0 0 32 32">
                    <rect x="6" y="10" width="20" height="14" rx="2" />
                    <path d="M12 10V8a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1v2" />
                    <circle cx="16" cy="17" r="4" />
                </svg>
            </div>
            <div class="title-group">
                <h1>AI Camera</h1>
                <p class="subtitle">Real-time herkenning en lokale data-analyse</p>
            </div>
        </div>
    </header>

    <div class="container">
        <div class="card">
            <div id="loader">
                <div class="spinner"></div>
                <p id="loaderStatus" style="font-size: 0.875rem; font-weight: 600; color: var(--slate-500);">Systemen opstarten...</p>
            </div>
            <h2 class="card-title">Live Analyse</h2>
            <div class="canvas-container">
                <video id="webcam" autoplay muted playsinline></video>
                <canvas id="overlay"></canvas>
            </div>

            <div class="settings-area">
                <div class="slider-label">
                    <span>Gevoeligheid van de AI</span>
                    <span id="threshVal">65%</span>
                </div>
                <input type="range" id="threshold" min="30" max="100" value="65">
            </div>
        </div>

        <div class="card">
            <h2 class="card-title">Gedetecteerde Objecten</h2>
            <div id="iconGrid" class="icon-grid">
                </div>
            
            <button class="btn-action" onclick="toggleCamera()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M20 10c0-4.418-3.582-8-8-8s-8 3.582-8 8c0 1.965.71 3.766 1.89 5.168"/>
                    <path d="M4 10h4v-4"/>
                    <path d="M4 14c0 4.418 3.582 8 8 8s8-3.582 8-8c0-1.965-.71-3.766-1.89-5.168"/>
                    <path d="M20 14h-4v4"/>
                </svg>
                Camera Wisselen
            </button>
            <button class="btn-action" onclick="location.reload()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="M23 4v6h-6"></path>
                    <path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"></path>
                </svg>
                Sessie herstarten
            </button>

            <details>
                <summary>Hoe werkt dit? <span>▼</span></summary>
                <div class="info-text">
                    <p><strong>Technologie:</strong> Deze applicatie maakt gebruik van TensorFlow.js en het COCO-SSD model om objecten direct in de browser te identificeren.</p>
                    <p style="margin-top: 8px;"><strong>Privacy:</strong> Alle berekeningen worden lokaal op dit apparaat uitgevoerd. Je videodata wordt nooit verzonden naar een externe server.</p>
                </div>
            </details>
        </div>
    </div>

    <footer class="footer">
        <span class="footer-quote">Niets is wat het lijkt.</span>
    </footer>

    <script>
        const video = document.getElementById('webcam');
        const canvas = document.getElementById('overlay');
        const ctx = canvas.getContext('2d');
        const iconGrid = document.getElementById('iconGrid');
        const loader = document.getElementById('loader');
        const loaderStatus = document.getElementById('loaderStatus');
        const threshInput = document.getElementById('threshold');
        const threshDisplay = document.getElementById('threshVal');

        let model;
        let seenObjects = new Set();
        let confidenceThreshold = 0.65;
        let currentFacingMode = 'environment'; // Start met camera aan de achterkant

        // Icoon Definities - Alle 80 COCO-SSD objecten (geoptimaliseerd voor kleine weergave)
        const iconPaths = {
            // === PERSONEN ===
            'person': '<path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle>',
            
            // === VOERTUIGEN ===
            'bicycle': '<circle cx="6" cy="15" r="4"></circle><circle cx="18" cy="15" r="4"></circle><path d="M6 15l6-9 6 9"></path><path d="M12 6v4"></path>',
            'car': '<rect x="3" y="10" width="18" height="7" rx="2"></rect><path d="M5 10l2-4h10l2 4"></path><circle cx="7" cy="17" r="2"></circle><circle cx="17" cy="17" r="2"></circle>',
            'motorcycle': '<circle cx="5" cy="16" r="3"></circle><circle cx="19" cy="16" r="3"></circle><path d="M8 16l4-8h3l2 5"></path><path d="M15 8l2-4"></path>',
            'airplane': '<path d="M12 3v18M4 11h16"></path><path d="M4 11l8-5 8 5"></path><path d="M9 19l3-2 3 2"></path>',
            'bus': '<rect x="3" y="5" width="18" height="12" rx="2"></rect><circle cx="7" cy="17" r="2"></circle><circle cx="17" cy="17" r="2"></circle><path d="M3 11h18"></path><path d="M7 5v6M12 5v6M17 5v6"></path>',
            'train': '<rect x="5" y="4" width="14" height="12" rx="3"></rect><circle cx="8" cy="18" r="2"></circle><circle cx="16" cy="18" r="2"></circle><path d="M5 10h14"></path><circle cx="12" cy="7" r="1" fill="currentColor"></circle>',
            'truck': '<rect x="2" y="9" width="13" height="9" rx="1"></rect><path d="M15 13h5l3 3v2h-8"></path><circle cx="6" cy="18" r="2"></circle><circle cx="18" cy="18" r="2"></circle>',
            'boat': '<path d="M3 17h18l-3-5H6z"></path><path d="M12 12V5"></path><path d="M8 8h8l-4-3z"></path>',
            
            // === VERKEER ===
            'traffic light': '<rect x="7" y="2" width="10" height="20" rx="2"></rect><circle cx="12" cy="6" r="2.5"></circle><circle cx="12" cy="12" r="2.5"></circle><circle cx="12" cy="18" r="2.5"></circle>',
            'fire hydrant': '<rect x="7" y="7" width="10" height="13" rx="2"></rect><rect x="9" y="3" width="6" height="4"></rect><path d="M4 12h4M16 12h4"></path>',
            'stop sign': '<polygon points="7,2 17,2 22,7 22,17 17,22 7,22 2,17 2,7"></polygon><path d="M7 12h10" stroke-width="3"></path>',
            'parking meter': '<circle cx="12" cy="8" r="6"></circle><rect x="10" y="14" width="4" height="8" rx="1"></rect><path d="M9 8h6"></path>',
            'bench': '<rect x="3" y="10" width="18" height="3" rx="1"></rect><path d="M5 13v7M19 13v7"></path><path d="M6 10V7M18 10V7"></path>',
            
            // === DIEREN ===
            'bird': '<ellipse cx="12" cy="10" rx="6" ry="5"></ellipse><path d="M18 8l4-2"></path><path d="M6 10H2"></path><path d="M10 15l2 5 2-5"></path>',
            'cat': '<circle cx="12" cy="12" r="6"></circle><path d="M6 6l3 4"></path><path d="M18 6l-3 4"></path><circle cx="9" cy="11" r="1.5" fill="currentColor"></circle><circle cx="15" cy="11" r="1.5" fill="currentColor"></circle><path d="M10 14l2 1 2-1"></path>',
            'dog': '<circle cx="12" cy="12" r="6"></circle><path d="M4 9c0-3 2-5 4-4"></path><path d="M20 9c0-3-2-5-4-4"></path><circle cx="9" cy="11" r="1.5" fill="currentColor"></circle><circle cx="15" cy="11" r="1.5" fill="currentColor"></circle><ellipse cx="12" cy="15" rx="3" ry="2"></ellipse>',
            'horse': '<ellipse cx="11" cy="12" rx="8" ry="5"></ellipse><path d="M4 9c-1-4 1-6 3-6"></path><path d="M19 12h3"></path><path d="M5 17v5M9 17v5M14 17v5M18 17v5"></path>',
            'sheep': '<ellipse cx="12" cy="11" rx="7" ry="5"></ellipse><circle cx="12" cy="11" r="5" stroke-dasharray="3 2"></circle><circle cx="12" cy="5" r="3"></circle><path d="M7 16v5M17 16v5"></path>',
            'cow': '<ellipse cx="12" cy="12" rx="7" ry="5"></ellipse><circle cx="12" cy="5" r="3"></circle><path d="M7 3L5 1M17 3l2-2"></path><ellipse cx="12" cy="6" rx="2" ry="1" fill="currentColor"></ellipse><path d="M6 17v5M18 17v5"></path>',
            'elephant': '<ellipse cx="13" cy="11" rx="8" ry="6"></ellipse><path d="M5 9c-3 1-3 6-2 9"></path><circle cx="17" cy="8" r="2" fill="currentColor"></circle><path d="M7 17v5M12 17v5M17 17v5"></path>',
            'bear': '<circle cx="12" cy="12" r="7"></circle><circle cx="6" cy="5" r="3"></circle><circle cx="18" cy="5" r="3"></circle><circle cx="9" cy="10" r="1.5" fill="currentColor"></circle><circle cx="15" cy="10" r="1.5" fill="currentColor"></circle><ellipse cx="12" cy="14" rx="3" ry="2"></ellipse>',
            'zebra': '<ellipse cx="11" cy="12" rx="8" ry="5"></ellipse><path d="M4 9c-1-4 1-6 3-6"></path><path d="M5 17v5M9 17v5M14 17v5M18 17v5"></path><path d="M6 10h3M6 13h4M14 10h3M13 13h4"></path>',
            'giraffe': '<ellipse cx="12" cy="17" rx="4" ry="3"></ellipse><rect x="10" y="5" width="4" height="12" rx="1"></rect><circle cx="12" cy="3" r="2"></circle><path d="M10 2l-1-2M14 2l1-2"></path><path d="M9 20v2M15 20v2"></path>',
            
            // === ACCESSOIRES ===
            'backpack': '<rect x="5" y="5" width="14" height="16" rx="3"></rect><path d="M9 5V3a3 3 0 0 1 6 0v2"></path><rect x="7" y="10" width="10" height="6" rx="1"></rect>',
            'umbrella': '<path d="M4 12a8 8 0 0 1 16 0"></path><path d="M12 12v9"></path><path d="M12 21a2 2 0 0 1-2-2"></path>',
            'handbag': '<path d="M6 9h12l-1 12H7z"></path><path d="M9 9V6a3 3 0 0 1 6 0v3"></path>',
            'tie': '<path d="M10 3h4l1 5-3 14-3-14z"></path><rect x="9" y="3" width="6" height="2" rx="0.5"></rect>',
            'suitcase': '<rect x="4" y="7" width="16" height="14" rx="2"></rect><path d="M8 7V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v3"></path><path d="M4 12h16"></path>',
            
            // === SPORT ===
            'frisbee': '<ellipse cx="12" cy="12" rx="10" ry="4"></ellipse><ellipse cx="12" cy="12" rx="4" ry="1.5"></ellipse>',
            'skis': '<rect x="6" y="3" width="2" height="18" rx="1"></rect><rect x="16" y="3" width="2" height="18" rx="1"></rect><path d="M3 21h7M14 21h7"></path>',
            'snowboard': '<rect x="2" y="10" width="20" height="5" rx="2.5"></rect><circle cx="7" cy="12.5" r="1.5"></circle><circle cx="17" cy="12.5" r="1.5"></circle>',
            'sports ball': '<circle cx="12" cy="12" r="9"></circle><path d="M12 3v18"></path><ellipse cx="12" cy="12" rx="4" ry="9"></ellipse>',
            'kite': '<polygon points="12,2 21,12 12,22 3,12"></polygon><path d="M12 22v2"></path><path d="M3 12h18"></path>',
            'baseball bat': '<path d="M5 19L15 9"></path><ellipse cx="18" cy="6" rx="3" ry="5" transform="rotate(45 18 6)"></ellipse><circle cx="4" cy="20" r="2"></circle>',
            'baseball glove': '<path d="M4 11a8 8 0 0 1 16 0c0 5-4 9-8 9s-8-4-8-9z"></path><path d="M8 9c0 3 2 5 4 5"></path><path d="M12 6v4"></path>',
            'skateboard': '<rect x="2" y="10" width="20" height="4" rx="2"></rect><circle cx="6" cy="17" r="3"></circle><circle cx="18" cy="17" r="3"></circle>',
            'surfboard': '<ellipse cx="12" cy="12" rx="4" ry="10"></ellipse><path d="M12 2v20"></path><path d="M8 12h8"></path>',
            'tennis racket': '<circle cx="12" cy="8" r="6"></circle><rect x="10" y="14" width="4" height="8" rx="1"></rect><path d="M6 8h12"></path><path d="M12 2v12"></path>',
            
            // === KEUKEN ===
            'bottle': '<rect x="9" y="2" width="6" height="3"></rect><path d="M8 5h8v15a3 3 0 0 1-3 3h-2a3 3 0 0 1-3-3V5z"></path>',
            'wine glass': '<path d="M8 3h8l-1 7a3 3 0 0 1-6 0z"></path><path d="M12 10v8"></path><path d="M8 22h8"></path>',
            'cup': '<path d="M5 7h10v11a3 3 0 0 1-3 3H8a3 3 0 0 1-3-3V7z"></path><path d="M15 9h3a3 3 0 0 1 0 6h-3"></path>',
            'fork': '<path d="M12 10v12"></path><path d="M8 3v5a4 4 0 0 0 8 0V3"></path><path d="M8 3v4M12 3v4M16 3v4"></path>',
            'knife': '<path d="M19 3L9 13v9"></path><path d="M12 10L19 3"></path>',
            'spoon': '<ellipse cx="12" cy="6" rx="4" ry="4"></ellipse><path d="M12 10v12"></path>',
            'bowl': '<ellipse cx="12" cy="10" rx="9" ry="3"></ellipse><path d="M3 10c0 5 4 8 9 8s9-3 9-8"></path>',
            
            // === VOEDSEL ===
            'banana': '<path d="M6 16c-2-5 1-12 12-12 0 5-3 14-10 14-2 0-2-2-2-2z"></path>',
            'apple': '<circle cx="12" cy="14" r="7"></circle><path d="M12 7c2-3 4-4 6-3"></path><path d="M12 7c-1-2 0-4 1-5"></path>',
            'sandwich': '<path d="M4 8c0-2 3-4 8-4s8 2 8 4"></path><rect x="4" y="8" width="16" height="10" rx="1"></rect><path d="M4 12h16M4 16h16"></path>',
            'orange': '<circle cx="12" cy="12" r="8"></circle><path d="M12 4v2"></path><path d="M12 12l5-5M12 12l-5-5M12 12l5 5M12 12l-5 5"></path>',
            'broccoli': '<circle cx="8" cy="8" r="5"></circle><circle cx="16" cy="8" r="5"></circle><circle cx="12" cy="5" r="5"></circle><rect x="10" y="13" width="4" height="9" rx="1"></rect>',
            'carrot': '<path d="M12 5L8 21h8z"></path><path d="M9 5c-2-2-4-2-5-1M15 5c2-2 4-2 5-1M12 5c0-2 0-4 0-5"></path>',
            'hot dog': '<rect x="3" y="9" width="18" height="7" rx="3.5"></rect><path d="M6 9c1-3 4-4 6-4s5 1 6 4"></path>',
            'pizza': '<path d="M12 4l9 16H3z"></path><circle cx="10" cy="12" r="2" fill="currentColor"></circle><circle cx="14" cy="14" r="2" fill="currentColor"></circle><circle cx="11" cy="17" r="2" fill="currentColor"></circle>',
            'donut': '<circle cx="12" cy="12" r="8"></circle><circle cx="12" cy="12" r="3"></circle><path d="M7 8l1 1M16 8l-1 1M7 16l1-1M16 16l-1-1"></path>',
            'cake': '<rect x="4" y="11" width="16" height="10" rx="1"></rect><path d="M4 15h16"></path><path d="M8 11V8M12 11V6M16 11V8"></path><circle cx="8" cy="6" r="1.5" fill="currentColor"></circle><circle cx="12" cy="4" r="1.5" fill="currentColor"></circle><circle cx="16" cy="6" r="1.5" fill="currentColor"></circle>',
            
            // === MEUBELS ===
            'chair': '<rect x="6" y="4" width="12" height="4" rx="1"></rect><path d="M7 8v5M17 8v5"></path><rect x="5" y="13" width="14" height="2" rx="0.5"></rect><path d="M7 15v6M17 15v6"></path>',
            'couch': '<rect x="2" y="9" width="20" height="9" rx="2"></rect><path d="M5 9V6a3 3 0 0 1 3-3h8a3 3 0 0 1 3 3v3"></path><path d="M2 13h20"></path><path d="M5 18v3M19 18v3"></path>',
            'potted plant': '<path d="M12 11c-2-4 0-8 0-8s2 4 0 8"></path><path d="M8 13c-3-2-3-6-3-6s3 1 3 6"></path><path d="M16 13c3-2 3-6 3-6s-3 1-3 6"></path><path d="M7 13h10l-1 8H8z"></path>',
            'bed': '<rect x="2" y="10" width="20" height="9" rx="1"></rect><path d="M2 14h20"></path><rect x="4" y="6" width="6" height="4" rx="1"></rect><path d="M4 19v2M20 19v2"></path>',
            'dining table': '<rect x="2" y="9" width="20" height="3" rx="1"></rect><path d="M5 12v9M19 12v9"></path>',
            'toilet': '<ellipse cx="12" cy="16" rx="6" ry="4"></ellipse><path d="M6 16V9a6 6 0 0 1 12 0v7"></path><rect x="17" y="8" width="4" height="6" rx="1"></rect>',
            
            // === ELEKTRONICA ===
            'tv': '<rect x="2" y="4" width="20" height="13" rx="2"></rect><path d="M9 21h6"></path><path d="M12 17v4"></path>',
            'laptop': '<rect x="2" y="5" width="20" height="11" rx="2"></rect><path d="M1 18h22" stroke-width="2"></path>',
            'mouse': '<rect x="7" y="3" width="10" height="16" rx="5"></rect><path d="M12 3v5"></path><circle cx="12" cy="10" r="1" fill="currentColor"></circle>',
            'remote': '<rect x="7" y="2" width="10" height="20" rx="3"></rect><circle cx="12" cy="7" r="2.5"></circle><rect x="9" y="11" width="6" height="3" rx="1"></rect><circle cx="9" cy="17" r="1.5" fill="currentColor"></circle><circle cx="15" cy="17" r="1.5" fill="currentColor"></circle>',
            'keyboard': '<rect x="1" y="7" width="22" height="10" rx="2"></rect><path d="M4 11h2M8 11h2M12 11h2M16 11h2M20 11h1"></path><rect x="6" y="14" width="12" height="1.5" rx="0.5"></rect>',
            'cell phone': '<rect x="6" y="2" width="12" height="20" rx="3"></rect><path d="M10 5h4"></path><circle cx="12" cy="18" r="2"></circle>',
            
            // === APPARATEN ===
            'microwave': '<rect x="2" y="5" width="20" height="14" rx="2"></rect><rect x="4" y="7" width="11" height="10" rx="1"></rect><circle cx="18" cy="10" r="1.5"></circle><circle cx="18" cy="15" r="1.5"></circle>',
            'oven': '<rect x="3" y="3" width="18" height="18" rx="2"></rect><rect x="5" y="8" width="14" height="11" rx="1"></rect><circle cx="7" cy="5.5" r="1"></circle><circle cx="11" cy="5.5" r="1"></circle><circle cx="15" cy="5.5" r="1"></circle>',
            'toaster': '<rect x="4" y="8" width="16" height="11" rx="3"></rect><path d="M7 8V4M12 8V3M17 8V4"></path><path d="M7 19v2M17 19v2"></path>',
            'sink': '<rect x="2" y="7" width="20" height="11" rx="2"></rect><ellipse cx="12" cy="12" rx="6" ry="4"></ellipse><path d="M12 3v4"></path><circle cx="12" cy="2" r="1.5" fill="currentColor"></circle>',
            'refrigerator': '<rect x="5" y="2" width="14" height="20" rx="2"></rect><path d="M5 9h14"></path><circle cx="16" cy="5.5" r="1"></circle><path d="M16 13v4"></path>',
            
            // === HUISHOUDEN ===
            'book': '<path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path><path d="M9 7h6M9 11h6M9 15h3"></path>',
            'clock': '<circle cx="12" cy="12" r="9"></circle><path d="M12 6v6l4 2"></path><circle cx="12" cy="12" r="1" fill="currentColor"></circle>',
            'vase': '<path d="M9 4h6"></path><path d="M9 4c-2 3-3 7-3 10 0 4 3 6 6 6s6-2 6-6c0-3-1-7-3-10z"></path>',
            'scissors': '<circle cx="6" cy="6" r="3"></circle><circle cx="6" cy="18" r="3"></circle><path d="M20 4L9 15"></path><path d="M20 20L9 9"></path>',
            'teddy bear': '<circle cx="12" cy="11" r="6"></circle><circle cx="6" cy="5" r="3"></circle><circle cx="18" cy="5" r="3"></circle><circle cx="9" cy="10" r="1.5" fill="currentColor"></circle><circle cx="15" cy="10" r="1.5" fill="currentColor"></circle><ellipse cx="12" cy="13" rx="2" ry="1.5"></ellipse><ellipse cx="12" cy="19" rx="4" ry="3"></ellipse>',
            'hair drier': '<circle cx="7" cy="10" r="5"></circle><path d="M12 7h7a2 2 0 0 1 2 2v2a2 2 0 0 1-2 2h-7"></path><path d="M3 10h8"></path><rect x="6" y="15" width="2" height="7" rx="1"></rect>',
            'toothbrush': '<rect x="10" y="2" width="4" height="5" rx="1"></rect><rect x="11" y="7" width="2" height="15" rx="0.5"></rect><path d="M10 3.5h4M10 5h4"></path>',
            
            // === DEFAULT ===
            'default': '<circle cx="12" cy="12" r="9"></circle><path d="M9 9h.01M15 9h.01"></path><path d="M8 14s1.5 2 4 2 4-2 4-2"></path>'
        };

        // Complete COCO-SSD Vertaallijst (80 Objecten)
        const vertaling = { 
            'person': 'Persoon', 'bicycle': 'Fiets', 'car': 'Auto', 'motorcycle': 'Motor', 'airplane': 'Vliegtuig',
            'bus': 'Bus', 'train': 'Trein', 'truck': 'Vrachtwagen', 'boat': 'Boot', 'traffic light': 'Stoplicht',
            'fire hydrant': 'Brandkraan', 'stop sign': 'Stopbord', 'parking meter': 'Parkeermeter', 'bench': 'Bankje',
            'bird': 'Vogel', 'cat': 'Kat', 'dog': 'Hond', 'horse': 'Paard', 'sheep': 'Schaap', 'cow': 'Koe',
            'elephant': 'Olifant', 'bear': 'Beer', 'zebra': 'Zebra', 'giraffe': 'Giraffe', 'backpack': 'Rugzak',
            'umbrella': 'Paraplu', 'handbag': 'Handtas', 'tie': 'Stropdas', 'suitcase': 'Koffer', 'frisbee': 'Frisbee',
            'skis': 'Ski\'s', 'snowboard': 'Snowboard', 'sports ball': 'Bal', 'kite': 'Vlieger', 'baseball bat': 'Honkbalknuppel',
            'baseball glove': 'Honkbalhandschoen', 'skateboard': 'Skateboard', 'surfboard': 'Surfplank', 'tennis racket': 'Tennisracket',
            'bottle': 'Fles', 'wine glass': 'Wijnglas', 'cup': 'Beker', 'fork': 'Vork', 'knife': 'Mes', 'spoon': 'Lepel',
            'bowl': 'Kom', 'banana': 'Banaan', 'apple': 'Appel', 'sandwich': 'Broodje', 'orange': 'Sinaasappel',
            'broccoli': 'Broccoli', 'carrot': 'Wortel', 'hot dog': 'Hotdog', 'pizza': 'Pizza', 'donut': 'Donut',
            'cake': 'Taart', 'chair': 'Stoel', 'couch': 'Bank', 'potted plant': 'Plant', 'bed': 'Bed',
            'dining table': 'Tafel', 'toilet': 'Toilet', 'tv': 'Televisie', 'laptop': 'Laptop', 'mouse': 'Muis',
            'remote': 'Afstandsbediening', 'keyboard': 'Toetsenbord', 'cell phone': 'Telefoon', 'microwave': 'Magnetron',
            'oven': 'Oven', 'toaster': 'Broodrooster', 'sink': 'Gootsteen', 'refrigerator': 'Koelkast', 'book': 'Boek',
            'clock': 'Klok', 'vase': 'Vaas', 'scissors': 'Schaar', 'teddy bear': 'Knuffelbeer', 'hair drier': 'Föhn',
            'toothbrush': 'Tandenborstel'
        };

        threshInput.oninput = (e) => {
            confidenceThreshold = e.target.value / 100;
            threshDisplay.innerText = e.target.value + '%';
        };

        // Functie om de camera stroom op te zetten (en oude te stoppen)
        async function setupCamera() {
            if (video.srcObject) {
                const tracks = video.srcObject.getTracks();
                tracks.forEach(track => track.stop());
            }

            try {
                const stream = await navigator.mediaDevices.getUserMedia({ 
                    video: { facingMode: currentFacingMode } 
                });
                video.srcObject = stream;
                
                return new Promise((resolve) => {
                    video.onloadedmetadata = () => {
                        canvas.width = video.videoWidth;
                        canvas.height = video.videoHeight;
                        resolve();
                    };
                });
            } catch (err) {
                loaderStatus.innerHTML = "<span style='color:#ef4444;'>Camera fout of geen toegang.</span>";
                console.error(err);
            }
        }

        // Functie om van camera te wisselen
        async function toggleCamera() {
            // Wissel modus
            currentFacingMode = (currentFacingMode === 'user') ? 'environment' : 'user';
            
            // Toon loader tijdens wissel
            loader.style.display = 'flex';
            loaderStatus.innerText = "Camera wisselen...";
            
            await setupCamera();
            
            loader.style.display = 'none';
        }

        async function init() {
            try {
                model = await cocoSsd.load();
                loaderStatus.innerText = "Camera activeren...";
                await setupCamera();
                loader.style.display = 'none';
                loop();
            } catch (err) {
                loaderStatus.innerHTML = "<span style='color:#ef4444;'>AI Model kon niet laden.</span>";
            }
        }

        async function loop() {
            if (!video.paused && !video.ended) {
                const predictions = await model.detect(video);
                ctx.clearRect(0, 0, canvas.width, canvas.height);
                predictions.forEach(p => {
                    if (p.score > confidenceThreshold) {
                        ctx.strokeStyle = '#10b981';
                        ctx.lineWidth = 3;
                        ctx.strokeRect(...p.bbox);
                        if (!seenObjects.has(p.class)) {
                            seenObjects.add(p.class);
                            const nlLabel = vertaling[p.class] || p.class;
                            const svg = iconPaths[p.class] || iconPaths['default'];
                            const div = document.createElement('div');
                            div.className = 'styled-icon-box';
                            div.innerHTML = `<div class="icon-circle"><svg viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">${svg}</svg></div><div class="icon-label">${nlLabel}</div>`;
                            iconGrid.appendChild(div);
                        }
                    }
                });
            }
            requestAnimationFrame(loop);
        }
        init();
    </script>
</body>
</html>